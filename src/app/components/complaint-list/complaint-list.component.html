<app-headerback></app-headerback>
<app-sideback></app-sideback>

<div id="page-wrapper">
  <div class="container-fluid">
    <div class="row bg-title">
      <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
        <h4 class="page-title">Complaint List</h4>
      </div>
    </div>

    <!-- Recherche par sentiment (liste dÃ©roulante) -->
    <div class="search-container">
      <select [(ngModel)]="searchSentiment" (ngModelChange)="applyFilter()" class="search-dropdown">
        <option value="">-- Select Sentiment --</option>
        <option value="Positif">Positif</option>
        <option value="Neutre">Neutre</option>
        <option value="NÃ©gatif">NÃ©gatif</option>
      </select>
    </div>
    
    <!-- Bouton pour ajouter une rÃ©clamation -->
    <div class="actions-container">
      <button class="create-btn" routerLink="/complaint-add">Create New Complaint</button>
    </div>
   
    <!-- Tableau des rÃ©clamations avec tri -->
    <table class="complaint-table">
      <thead>
        <tr>
          <th (click)="sortBy('subject')">
            Subject
            <span *ngIf="sortField === 'subject'">
              {{ sortDirection === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
            </span>
          </th>
          <th (click)="sortBy('description')">
            Description
            <span *ngIf="sortField === 'description'">
              {{ sortDirection === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
            </span>
          </th>
          <th (click)="sortBy('submissionDate')">
            Submission Date
            <span *ngIf="sortField === 'submissionDate'">
              {{ sortDirection === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
            </span>
          </th>
          <th (click)="sortBy('status')">
            Status
            <span *ngIf="sortField === 'status'">
              {{ sortDirection === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
            </span>
          </th>
          <th (click)="sortBy('sentiment')">
            Sentiment
            <span *ngIf="sortField === 'sentiment'">
              {{ sortDirection === 'asc' ? 'ðŸ”¼' : 'ðŸ”½' }}
            </span>
          </th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let complaint of filteredComplaints">
          <td>{{ complaint.subject }}</td>
          <td>{{ complaint.description }}</td>
          <td>{{ complaint.submissionDate | date }}</td>
          <td>{{ complaint.status }}</td>
          <td>
            <span [ngStyle]="{'color': getSentimentColor(complaint.sentiment)}">
              {{ complaint.sentiment }}
            </span>
          </td>
          <td class="action-buttons">
            <button class="update-btn" (click)="onUpdate(complaint.id_complaint)">Update</button>
            <button class="delete-btn" (click)="onDelete(complaint.id_complaint)">Delete</button>
            <button class="response-btn" (click)="onAddResponse(complaint.id_complaint)">Add Response</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
